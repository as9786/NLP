# CNN-LSTM 조합모델을 이용한 영화리뷰 감성분석

## 1. 서론

- 분류분석 연구는 전통적으로 정형 데이터에 적용
- 최근에는 텍스트, 이미지, 오디오 데이터 등 비정형 데이터에서도 많은 연구가 진행
- 감성분야 in NLP : 온라인 텍스트에서 감성, 주관적인 생각, 감정 등을 식별하고, 서비스에 대한 느낌을 분석
- 텍스트 시퀀스를 사전 정의된 범주를 이용하여 분류
- 극성분석 : 문장 관점에서의 분류분석
- 극성분석은 문서 내 의견이 긍정인지 부정인지 중립이지만 분류
- 선행연구에서는 주로 인공 신경망, SVM 등의 단순 기계학습기법을 활용하였지만 분류 성과가 미흡
- CNN : 얼굴인식이나 이미지 분류에서 사용되는 알고리즘. NLP에서는 BOW 유사하게 사용
- LSTM : 주어진 단어를 미리 예측할 수 있도록 순차적으로 배열할 수 있는 장점
- CNN-LSTM의 조합 모델을 이용하게 되면 양자의 장점을 활용 가능
- 딥러닝 기반 모델들은 자연어처리 등 여러 분야에서 전통적인 기계학습기법보다 뛰어난 성능을 갖고 있음


## 2. 문헌연구

### 2.1 기계학습기법을 이용한 감성분석
- 기본적인 감정분석은 긍정과 부정에 대한 빈도수 기반으로 제한
- 사용자의 의도와 반응을 도출
- 나이브베이즈, 인공신경망, SVM
- SVM이 가장 우수한 정확도
- 텍스트 분류에서 짧은 텍스트를 처리할 때에는 다항성과 동의어 문제에 직면
- 위 문제를 해결하기 위해 앙상블 기법
- 일반적으로 감성분석은 영화 리뷰 데이터에 자주 적용(평점이 존재)

### 2.2 딥러닝 기법
- 딥러닝 : 일반적으로 기계학습기법의 하나인 신경망의 계층을 심화시킨 알고리즘
- 특징 집합을 추출하는 과정뿐만 아니라, 복잡한 특징을 자동으로 추출
- CNN은 합성곱층과 pooling layer로 구성.
- 합성곱층에서는 가중치화 편향을 적용, pooling layer에서는 활성화를 수행한 합성곱층에서 벡터를 형성하여 가져옴
- CNN은 오탈자가 있어도 감성분석에 탁월

- LSTM은 장기 의존성 문제를 해결하기 위해 고안된 모델
- 입력 게이트, 출력 게이트, 망각 게이트 등 3개의 gate 구조를 가지고 있음
- 입출력 시점의 상태를 LSTM에 전달하면, 현재시점의 출력이 완전 연결 계층에 전달되어 업데이트 된 시점을 출력

## 3. CNN-LSTM 조합모델
- CNN 대규모 병렬 처리
- LSTM은 병렬 처리 불가, RNN과는 다르게 원하는 시기에 진행 및 제어 할 수 있는 입력, 출력, 망각 게이트가 있음
- LSTM의 게이트는 메모리 블록을 은닉노드에 배치할 수 있음
- 모든 데이터를 기억할 수는 없지만, CNN의 장기 의존성 문제를 해결
- LSTM을 CNN의 pooling layer에서 이용할 경우, end-to-end 구조를 띄기 때문에 공간 및 시간적인 특징을 동시에 고려 
- Wordembedding의 출력을 통해 텍스트 매트릭스 벡터를 만드는 과정에서 CNN을 도입
- 합성곱층의 목적은 kernel의 크기를 조정하여 다른 단어와 함께 사용될 때 다른 단어를 이해하게 할 수 있는 구조

## 4. 분석과정

### 4.1 연구 데이터와 전처리
- training 80%, validation 20%로 두었다
- 텍스트 리뷰 데이터에서 부호를 제거한 후, 토큰화를 진행
- TF-IDF : 각 문서에 대한 상대 용어 빈도를 이용
- TF : 문서 내의 단어의 빈도 수
- IDF : 동일한 단어 내에서의 또 다른 문서별 빈도수 정의
### 4.2 분석 절차
- NB, SVM, XGboost와 비교

### 4.3 분석 결과

![image](https://user-images.githubusercontent.com/80622859/204272562-336f8f0b-62db-4485-9164-76f2bd34eb05.png)


- 
